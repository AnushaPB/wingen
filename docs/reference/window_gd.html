<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Sliding window map of genetic diversity"><title>Sliding window map of genetic diversity — window_gd • wingen</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sliding window map of genetic diversity — window_gd"><meta property="og:description" content="Sliding window map of genetic diversity"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">wingen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/wingen-vignette.html">Wingen Vignette</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sliding window map of genetic diversity</h1>
      
      <div class="d-none name"><code>window_gd.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Sliding window map of genetic diversity</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">window_gd</span><span class="op">(</span>
  <span class="va">vcf</span>,
  <span class="va">coords</span>,
  <span class="va">lyr</span>,
  stat <span class="op">=</span> <span class="st">"pi"</span>,
  fact <span class="op">=</span> <span class="fl">0</span>,
  wdim <span class="op">=</span> <span class="fl">5</span>,
  rarify <span class="op">=</span> <span class="cn">FALSE</span>,
  rarify_n <span class="op">=</span> <span class="fl">4</span>,
  rarify_nit <span class="op">=</span> <span class="fl">5</span>,
  min_n <span class="op">=</span> <span class="fl">2</span>,
  fun <span class="op">=</span> <span class="va">mean</span>,
  parallel <span class="op">=</span> <span class="cn">FALSE</span>,
  nloci <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>vcf</dt>
<dd><p>object of type vcf ( (<em>note:</em> order matters! the coordinate and genetic data should be in the same order, there are currently no checks for this.))</p></dd>
<dt>coords</dt>
<dd><p>coordinates (two columns, the first should be x and the second should be y and the order should be the same as the genetic data),</p></dd>
<dt>lyr</dt>
<dd><p>RasterLayer to slide window across</p></dd>
<dt>stat</dt>
<dd><p>genetic diversity stat to calculate (can either be "pi" for nucleotide diversity, "het" for average heterozygosity across all loci, "allelic.richness" for average allelic richness across all loci, or "biallelic.richness" to get average allelic richness across all loci for a biallelic dataset (this option faster than "allelic.richness"))</p></dd>
<dt>fact</dt>
<dd><p>aggregation factor to apply to the RasterLayer (<em>note:</em> increasing this value reduces computational time)</p></dd>
<dt>wdim</dt>
<dd><p>dimensions (height x width) of window, if only one value is provided a square window is created</p></dd>
<dt>rarify</dt>
<dd><p>if rarify = TRUE, rarefaction is performed</p></dd>
<dt>rarify_n</dt>
<dd><p>if rarify = TRUE, number of points to use for rarefaction</p></dd>
<dt>rarify_nit</dt>
<dd><p>if rarify = TRUE, number of iterations to use for rarefaction</p></dd>
<dt>min_n</dt>
<dd><p>min number of samples to calculate allelic richness for (equal to rarify_n if provided, otherwise defaults to 2)</p></dd>
<dt>fun</dt>
<dd><p>function to use to summarize data in window (defaults to base R mean)</p></dd>
<dt>parallel</dt>
<dd><p>whether to parallelize the function (see vignette for setting up a cluster to do so)</p></dd>
<dt>nloci</dt>
<dd><p>for calculating pi, if nloci=NULL (default), returns the sum over SNPs of nucleotide diversity; otherwise return the average nucleotide diversity per nucleotide given the length nloci of the sequence (L argument in <a href="https://rdrr.io/pkg/hierfstat/man/pi.dosage.html" class="external-link">pi.dosage</a> function)</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>RasterStack that includes a raster of genetic diversity and a raster of the number of samples within the window for each cell</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="load_mini_ex.html">load_mini_ex</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in load_mini_ex():</span> could not find function "load_mini_ex"</span>
<span class="r-in"><span class="va">wpi</span> <span class="op">&lt;-</span> <span class="fu">window_gd</span><span class="op">(</span><span class="va">vcf</span>, <span class="va">coords</span>, <span class="va">lyr</span>, stat <span class="op">=</span> <span class="st">"pi"</span>, nloci <span class="op">=</span> <span class="fl">10</span>, rarify_n <span class="op">=</span> <span class="fl">4</span>, rarify_nit <span class="op">=</span> <span class="fl">5</span>, rarify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in window_gd(vcf, coords, lyr, stat = "pi", nloci = 10, rarify_n = 4,     rarify_nit = 5, rarify = TRUE):</span> object 'vcf' not found</span>
<span class="r-in"><span class="va">whet</span> <span class="op">&lt;-</span> <span class="fu">window_gd</span><span class="op">(</span><span class="va">vcf</span>, <span class="va">coords</span>, <span class="va">lyr</span>, stat <span class="op">=</span> <span class="st">"het"</span>, nloci <span class="op">=</span> <span class="fl">10</span>, rarify_n <span class="op">=</span> <span class="fl">4</span>, rarify_nit <span class="op">=</span> <span class="fl">5</span>, rarify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in window_gd(vcf, coords, lyr, stat = "het", nloci = 10, rarify_n = 4,     rarify_nit = 5, rarify = TRUE):</span> object 'vcf' not found</span>
<span class="r-in"><span class="va">war</span> <span class="op">&lt;-</span> <span class="fu">window_gd</span><span class="op">(</span><span class="va">vcf</span>, <span class="va">coords</span>, <span class="va">lyr</span>, stat <span class="op">=</span> <span class="st">"biallelic.richness"</span>, nloci <span class="op">=</span> <span class="fl">10</span>, rarify_n <span class="op">=</span> <span class="fl">4</span>, rarify_nit <span class="op">=</span> <span class="fl">5</span>, rarify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in window_gd(vcf, coords, lyr, stat = "biallelic.richness", nloci = 10,     rarify_n = 4, rarify_nit = 5, rarify = TRUE):</span> object 'vcf' not found</span>
<span class="r-in"><span class="fu"><a href="plot_gd.html">plot_gd</a></span><span class="op">(</span><span class="va">wpi</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'plot': object 'wpi' not found</span>
<span class="r-in"><span class="fu"><a href="plot_gd.html">plot_gd</a></span><span class="op">(</span><span class="va">whet</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'plot': object 'whet' not found</span>
<span class="r-in"><span class="fu"><a href="plot_gd.html">plot_gd</a></span><span class="op">(</span><span class="va">war</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'plot': object 'war' not found</span>
<span class="r-in"><span class="fu"><a href="plot_count.html">plot_count</a></span><span class="op">(</span><span class="va">wpi</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'plot': object 'wpi' not found</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Anusha Bishop, Anne Chambers, Ian Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

